/*! hbp-collaboratory-app-toolkit - v0.0.1 - 2016-01-06
* Copyright (c) 2016 EPFL; Licensed  */
!function(a,b){"use strict";"function"==typeof define&&define.amd?define([],function(){return b(a)}):"object"==typeof exports?module.exports=b(a):"object"==typeof angular?angular.module("hbpCollaboratoryAppToolkit",[]).factory("hbpCollaboratoryAppToolkit",["$window",function(a){return b(a)}]):a.hbpCollaboratoryAppToolkit=b(a)}(this,function(a){"use strict";function b(){}function c(b,c,d){a.parent.postMessage({apiVersion:1,eventName:b,data:c,ticket:++g},"*"),h[g]=d}function d(a){for(var b={},c=(a||"").split("&"),d=0;d<c.length;d++){a=c[d];var f,g,h;a&&(g=a=a.replace(/\+/g,"%20"),f=a.indexOf("="),-1!==f&&(g=a.substring(0,f),h=a.substring(f+1)),g=e(g),void 0!==g&&(h=void 0!==h?e(h):!0,hasOwnProperty.call(b,g)?"array"==typeof b[g]?b[g].push(h):b[g]=[b[g],h]:b[g]=h))}return b}function e(a){try{return decodeURIComponent(a)}catch(b){$log.debug("invalid value",a)}}function f(){var a=location.href.split("?");if(a.length<1)throw new Error("Missing Context");var b=a[a.length-1];return obj=d(b),{ctx:obj.ctx,state:obj.ctxstate}}var g=0,h={};return b.prototype={emit:c,context:f},a.addEventListener("message",function(a){a.data.origin&&h[a.data.origin]&&("resolved"===a.data.eventName?h[a.data.origin](null,a.data.data):"error"===a.data.eventName&&h[a.data.origin](a.data.data),h[a.data.origin]=null)}),new b});