/*! hbp-collaboratory-app-toolkit - v0.1.0 - 2016-01-15
* Copyright (c) 2016 EPFL; Licensed  */
!function(a,b){"use strict";"function"==typeof define&&define.amd?define([],function(){return b(a)}):"object"==typeof exports?module.exports=b(a):"object"==typeof angular?angular.module("hbpCollaboratoryAppToolkit",[]).factory("hbpCollaboratoryAppToolkit",["$window",function(a){return b(a)}]):a.hbpCollaboratoryAppToolkit=b(a)}(this,function(a){"use strict";function b(){}function c(b,c,d){a.parent.postMessage({apiVersion:1,eventName:b,data:c,ticket:++e},"*"),f[e]=d}function d(a,b){"function"==typeof arguments[0]&&(b=a,a=null);var d=setTimeout(function(){b({type:"TimeoutException",message:"No context can be retrieved"},null)},250);a&&(g=null),g&&b(null,g),c("workspace.context",a,function(a,c){clearTimeout(d),a?b(a):(g=c,b(null,g))})}var e=0,f={};b.prototype={emit:c,context:d},a.addEventListener("message",function(a){a.data.origin&&f[a.data.origin]&&("resolved"===a.data.eventName?f[a.data.origin](null,a.data.data):"error"===a.data.eventName&&f[a.data.origin](a.data.data),f[a.data.origin]=null)});var g;return new b});